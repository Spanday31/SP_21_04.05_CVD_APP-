<Insert the full final code from the canvas here>